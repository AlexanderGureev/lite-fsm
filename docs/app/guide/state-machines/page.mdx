# Конечные автоматы

Конечные автоматы (Finite State Machines, FSM) - это математическая модель, которая описывает поведение системы, которая может находиться только в одном из конечного числа состояний в каждый момент времени.

## Основные компоненты конечного автомата

1. **Состояния** - конечный набор возможных состояний системы.
2. **События** - действия, которые могут вызвать переход из одного состояния в другое.
3. **Переходы** - функции, определяющие новое состояние на основе текущего состояния и события.
4. **Начальное состояние** - состояние, в котором система находится до начала работы.

## Визуализация конечного автомата

Конечные автоматы часто представляют в виде диаграмм состояний, где:

- Состояния изображаются как круги или прямоугольники
- Переходы изображаются как стрелки между состояниями
- Стрелки помечаются событиями, которые вызывают переход

Пример диаграммы простого автомата:

```
   +-------+   TOGGLE    +-------+
   |       |------------>|       |
   | ВЫКЛ  |             |  ВКЛ  |
   |       |<------------|       |
   +-------+   TOGGLE    +-------+
```

## Преимущества использования конечных автоматов

### 1. Предсказуемость и строгая структура

FSM делает поведение системы предсказуемым и ясным. В каждый момент времени система находится в определенном состоянии, и переходы между состояниями чётко определены.

### 2. Управление сложностью

FSM позволяет разделить сложную логику на понятные дискретные состояния и правила перехода между ними.

### 3. Отладка и тестирование

Модель FSM упрощает отладку и тестирование, потому что:

- Состояния можно перечислить и проверить
- Переходы предсказуемы и детерминированы
- Легко понять, как система перешла в текущее состояние

### 4. Документирование поведения

Диаграммы состояний FSM могут служить наглядной документацией того, как должна работать система.

## Применение конечных автоматов

Конечные автоматы широко используются в различных областях:

- **UI компоненты**: для управления состояниями интерфейса (открыт/закрыт, активен/неактивен)
- **Бизнес-процессы**: для моделирования рабочих процессов (новый, в работе, проверка, завершено)
- **Протоколы связи**: для управления соединениями (подключение, подключено, отключение)
- **Игровые механики**: для управления состояниями игровых объектов (простой, перемещение, атака)
- **Парсеры и компиляторы**: для разбора и анализа текста

## Конечные автоматы в lite-fsm

Библиотека `lite-fsm` предоставляет удобный API для создания и управления конечными автоматами в JavaScript/TypeScript приложениях:

```ts
import { createMachine, MachineManager } from "lite-fsm";

// Определение автомата
const playerMachine = createMachine({
  config: {
    IDLE: {
      WALK: "WALKING",
      RUN: "RUNNING",
    },
    WALKING: {
      STOP: "IDLE",
      SPEED_UP: "RUNNING",
    },
    RUNNING: {
      STOP: "IDLE",
      SLOW_DOWN: "WALKING",
    },
  },
  initialState: "IDLE",
  initialContext: {
    speed: 0,
    direction: null,
  },
});

// Создание менеджера
const manager = MachineManager({ player: playerMachine });

// Вызов перехода
manager.transition({ type: "WALK", payload: { direction: "north", speed: 3 } });
```

## Расширенные типы конечных автоматов

Помимо базовых FSM, существуют и более сложные вариации:

### Автомат Мура

Выходные значения связаны с состояниями, а не с переходами.

### Автомат Мили

Выходные значения связаны с переходами, а не с состояниями.

### Иерархические автоматы

Состояния могут иметь вложенные подсостояния, что позволяет моделировать более сложное поведение.

### Параллельные автоматы

Несколько автоматов могут работать параллельно, взаимодействуя друг с другом.

## Заключение

Конечные автоматы - это мощный инструмент для моделирования и управления поведением систем. Они предоставляют формальную и строгую структуру, которая позволяет создавать надежные и предсказуемые приложения.
